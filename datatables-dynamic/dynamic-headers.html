<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Datatable with dynamic headers</title>

    <link rel="stylesheet" type="text/css" href="datatables.min.css">
    <script src="datatables.min.js"></script>
</head>

<body>
    <h2>Skygate front-end LAB Datatable example with dynamic headers</h2>

    <table id="demotable" class="table table-striped table-condensed dataTable">
        <thead><tr></tr></thead>
    </table>


    <script>
        var data,
                tableName= '#demotable',
                columns,
                str,
                 jqxhr = $.ajax('../admin_ajax_report.php?action=get_report&report='+report_type+'&from_date='+from_date+'&to_date='+to_date+'&source_state='+source_state+'&source_city='+source_city)
                        .done(function () {
                            data = JSON.parse(jqxhr.responseText);

                // Iterate each column and print table headers for Datatables
                $.each(data.columns, function (k, colObj) {
                    str = '<th>' + colObj.name + '</th>';
                    $(str).appendTo(tableName+'>thead>tr');
                });
				
				data.columns[0].render = function (data, type, row) {
                    return '<h4>' + data + '</h4>';
                }
                        // Debug? console.log(data.columns[0]);

                $(tableName).dataTable({
                    "data": data.data,
                    "columns": data.columns,
                    "fnInitComplete": function () {
                        // Event handler to be fired when rendering is complete (Turn off Loading gif for example)
                        console.log('Datatable rendering complete');
                    }
                });
            })
            .fail(function (jqXHR, exception) {
                            var msg = '';
                            if (jqXHR.status === 0) {
                                msg = 'Not connect.\n Verify Network.';
                            } else if (jqXHR.status == 404) {
                                msg = 'Requested page not found. [404]';
                            } else if (jqXHR.status == 500) {
                                msg = 'Internal Server Error [500].';
                            } else if (exception === 'parsererror') {
                                msg = 'Requested JSON parse failed.';
                            } else if (exception === 'timeout') {
                                msg = 'Time out error.';
                            } else if (exception === 'abort') {
                                msg = 'Ajax request aborted.';
                            } else {
                                msg = 'Uncaught Error.\n' + jqXHR.responseText;
                            }
                console.log(msg);
            });
    </script>



</body>

</html>
